/* Martijn Rutte. Something going wrong with recognition of TEMPLATE part of the utility call
no viable alternative at input ''TEMPLATE
We do not need entire DSNUTILU, TEMPLATE, COPY etc. options here, but mapa should not fail on it either.
Discuss this one with Craig
Below a nice sample to test with
*/

SET CURRENT SQLID = PFSE01;
SET SCHEMA PFSE01;

 --#SET TERMINATOR ;
-- BTVK-12585 Legen M-tabellen
-- DB2 qualifier toegevoegd
--
CALL SYSPROC.DSNUTILU('PFS.MVRLOAD', 'NO', 
'TEMPLATE SREC DSN(''NULLFILE'') 
TEMPLATE SOUT   DSN(''EPFS.&DB..PFSTSMVR.SORTOUT.DB2'') STORCLAS TEMP  RETPD 1 SPACE (1 , 1) CYL DISP (MOD, DELETE, CATLG) 
TEMPLATE SUT1    DSN(''EPFS.&DB..PFSTSMVR.SYSUT1.DB2'')  STORCLAS DCFILE  RETPD 1 SPACE (1000 , 500) CYL DISP (MOD, DELETE, CATLG) 
TEMPLATE WERKSYS1  DSN(''EPFS.&DB..PFSTSMVR.DB2WORK.DB2'') STORCLAS TEMP  RETPD 1 SPACE (1000 , 500) CYL DISP (MOD, DELETE, CATLG) 
LOAD DATA INDDN(SREC) REPLACE REUSE LOG NO WORKDDN (SUT1,SOUT) NOCOPYPEND SORTKEYS 0 SORTDEVT SYSDA SORTNUM 5 
 INTO TABLE
 "PFSE01".
 "M_PARKEERTICKET"
 IGNOREFIELDS YES
 ( "M_PARKEERTICKET_ID"
  POSITION(  00003:00010) BIGINT
 , "M_PARKEERPLAATS_ID"
  POSITION(  00011:00012) SMALLINT
 , "M_BEHANDELING_ID"
  POSITION(  00013:00020) BIGINT
 , "TS_TICKET_AANGEMAAKT"
  POSITION(  00021:00046) TIMESTAMP EXTERNAL(026)
 , "TS_TICKET_GELDIG_TM"
  POSITION(  00047:00072) TIMESTAMP EXTERNAL(026)
 , "TS_CONTROLE_MOMENT"
  POSITION(  00073:00098) TIMESTAMP EXTERNAL(026)
 , "CURRENT_MONTH"
  POSITION(  00099:00100) DECIMAL
  )
LOAD DATA INDDN(SREC) REPLACE REUSE LOG NO WORKDDN (SUT1,SOUT) NOCOPYPEND SORTKEYS 0 SORTDEVT SYSDA SORTNUM 5 
 INTO TABLE
 "PFSE01".
 "M_STATEMENT"
 IGNOREFIELDS YES
 ( "M_STATEMENT_ID"
  POSITION(  00003:00010) BIGINT
 , "IBAN"
  POSITION(  00011:00054) VARCHAR MIXED
 , "SEQUENCENR"
  POSITION(  00055:00056) SMALLINT
 , "STATEMENT_STATUS"
  POSITION(  00057:00082) VARCHAR MIXED
 , "AANTAL"
  POSITION(  00083:00086) INTEGER
 , "CURRENT_MONTH"
  POSITION(  00087:00088) DECIMAL
 , "FROM_DATE_TIME"
  POSITION(  00115:00140) TIMESTAMP EXTERNAL(026)
   )
LOAD DATA INDDN(SREC) REPLACE REUSE LOG NO WORKDDN (SUT1,SOUT) NOCOPYPEND SORTKEYS 0 SORTDEVT SYSDA SORTNUM 5 
 INTO TABLE
 "PFSE01".
 "M_VORDERING_WAARDE"
 IGNOREFIELDS YES
 ( "M_VORDERING_ID"
  POSITION(  00003:00010) BIGINT
 , "M_WAARDE_ID"
  POSITION(  00011:00018) BIGINT
 , "CURRENT_MONTH"
  POSITION(  00019:00020) DECIMAL
 , "WAARDERING"
  POSITION(  00048:00049) SMALLINT
                          NULLIF(00047)=X'FF'
   )
LOAD DATA INDDN(SREC) REPLACE REUSE LOG NO WORKDDN (SUT1,SOUT) NOCOPYPEND SORTKEYS 0 SORTDEVT SYSDA SORTNUM 5 
 INTO TABLE
 "PFSE01".
 "M_WAARDE"
 IGNOREFIELDS YES
 ( "M_WAARDE_ID"
  POSITION(  00003:00010) BIGINT
 , "M_BEHANDELING_ID"
  POSITION(  00011:00018) BIGINT
 , "AFGELEID_VAN_WAARDE_ID"
  POSITION(  00020:00027) BIGINT
                          NULLIF(00019)=X'FF'
 , "TYPE_WAARDE"
  POSITION(  00028:00093) VARCHAR MIXED
 , "WAARDE"
  POSITION(  00094:00351) VARCHAR MIXED
 , "INFO"
  POSITION(  00353:00610) VARCHAR MIXED
                          NULLIF(00352)=X'FF'
 , "BRON"
  POSITION(  00612:00677) VARCHAR MIXED
                          NULLIF(00611)=X'FF'
 , "CURRENT_MONTH"
  POSITION(  00678:00679) DECIMAL
 , "M_PATROON_KEY"
  POSITION(  00707:00708) SMALLINT
                          NULLIF(00706)=X'FF'
   )

LOAD DATA INDDN(SREC) REPLACE REUSE LOG NO WORKDDN (SUT1,SOUT) NOCOPYPEND SORTKEYS 0 SORTDEVT SYSDA SORTNUM 5 
 INTO TABLE
 "PFSE01".
 "M_TOEKENNING_ADMIN"
 IGNOREFIELDS YES
 ( "M_TOEKENNING_ID"
  POSITION(  00003:00010) BIGINT
 , "M_SCENARIO_ID"
  POSITION(  00011:00018) BIGINT
 , "BD_COMPONENT_REF"
  POSITION(  00019:00050) CHAR MIXED(032)
 , "BRON_ADMINISTRATIE"
  POSITION(  00051:00057) VARCHAR MIXED
 , "TOEGEKEND_BEDRAG"
  POSITION(  00058:00067) DECIMAL
 , "CURRENT_MONTH"
  POSITION(  00068:00069) DECIMAL
 )
LOAD DATA INDDN(SREC) REPLACE REUSE LOG NO WORKDDN (SUT1,SOUT) NOCOPYPEND SORTKEYS 0 SORTDEVT SYSDA SORTNUM 5 
 INTO TABLE
 "PFSE01".
 "M_TOEKENNING_VORDERING"
 IGNOREFIELDS YES
 ( "M_TOEKENNING_ID"
  POSITION(  00003:00010) BIGINT
 , "M_SCENARIO_ID"
  POSITION(  00011:00018) BIGINT
 , "BD_COMPONENT_REF"
  POSITION(  00019:00050) CHAR MIXED(032)
 , "M_VORDERING_ID"
  POSITION(  00051:00058) BIGINT
 , "TOEGEKEND_BEDRAG"
  POSITION(  00059:00068) DECIMAL
 , "CURRENT_MONTH"
  POSITION(  00069:00070) DECIMAL
 )
LOAD DATA INDDN(SREC) REPLACE REUSE LOG NO WORKDDN (SUT1,SOUT) NOCOPYPEND SORTKEYS 0 SORTDEVT SYSDA SORTNUM 5 
 INTO TABLE
 "PFSE01".
 "M_SCENARIO"
 IGNOREFIELDS YES
 ( "M_SCENARIO_ID"
  POSITION(  00003:00010) BIGINT
 , "M_BEHANDELING_ID"
  POSITION(  00011:00018) BIGINT
 , "WAARSCHIJNLIJKHEID"
  POSITION(  00019:00020) SMALLINT
 , "GEKOZEN_TF"
  POSITION(  00021:00021) CHAR MIXED(001)
 , "CURRENT_MONTH"
  POSITION(  00022:00023) DECIMAL
 , "UID_BEHANDELING"
  POSITION(  00051:00057) CHAR MIXED(007)
                          NULLIF(00050)=X'FF'
 , "TS_BEHANDELING"
  POSITION(  00059:00084) TIMESTAMP EXTERNAL(026)
                          NULLIF(00058)=X'FF'
 , "UID_GOEDKEURING"
  POSITION(  00086:00092) CHAR MIXED(007)
                          NULLIF(00085)=X'FF'
 , "TS_GOEDKEURING"
  POSITION(  00094:00119) TIMESTAMP EXTERNAL(026)
                          NULLIF(00093)=X'FF'
 , "SCENARIO_TYPE"
  POSITION(  00120:00153) VARCHAR MIXED
   )
LOAD DATA INDDN(SREC) REPLACE REUSE LOG NO WORKDDN (SUT1,SOUT) NOCOPYPEND SORTKEYS 0 SORTDEVT SYSDA SORTNUM 5 
 INTO TABLE
 "PFSE01".
 "M_VORDERING"
 IGNOREFIELDS YES
 ( "M_VORDERING_ID"                                        
  POSITION(  00003:00010) BIGINT                           
 , "M_BEHANDELING_ID"                                      
  POSITION(  00011:00018) BIGINT                           
 , "VORDERING_KENMERK_BRON"                                
  POSITION(  00019)       VARCHAR MIXED                    
 , "OPENSTAAND_BEDRAG"                                     
  POSITION(  *)           DECIMAL                          
 , "CODE_BRON_SYSTEEM"                                     
  POSITION(  *)           VARCHAR MIXED                    
 , "DETAILS"                                               
  POSITION(  *)           VARCHAR MIXED                     
 , "DSN_NULL_IND_00007" POSITION(  *)           CHAR(1)    
 , "BELASTING_MIDDEL"                                      
  POSITION(  *)           VARCHAR MIXED                    
                          NULLIF(DSN_NULL_IND_00007)=X'FF' 
 , "PERSOONIDENTIFICATIE"                                  
  POSITION(  *)           VARCHAR MIXED                    
 , "DSN_NULL_IND_00009" POSITION(  *)           CHAR(1)    
 , "TERMIJN_BEDRAG"                                        
  POSITION(  *)           DECIMAL                          
                          NULLIF(DSN_NULL_IND_00009)=X'FF' 
 , "DSN_NULL_IND_00010" POSITION(  *)           CHAR(1)    
 , "UBD_OF_VERVAL_DATUM"                                   
  POSITION(  *)           DATE EXTERNAL                    
                          NULLIF(DSN_NULL_IND_00010)=X'FF' 
 , "CURRENT_MONTH"                                         
  POSITION(  *)           DECIMAL                          
 )                                                         
LOAD DATA INDDN(SREC) REPLACE REUSE LOG NO WORKDDN (SUT1,SOUT) NOCOPYPEND SORTKEYS 0 SORTDEVT SYSDA SORTNUM 5 
 INTO TABLE
 "PFSE01".
 "M_VORDERING_EIGENSCHAP"
 IGNOREFIELDS YES
 ( "M_VORDERING_EIGENSCHAP_ID"
  POSITION(  00003:00010) BIGINT
 , "M_VORDERING_ID"
  POSITION(  00011:00018) BIGINT
 , "EIGENSCHAP_TYPE"
  POSITION(  00019:00148) VARCHAR MIXED
 , "EIGENSCHAP_WAARDE"
  POSITION(  00149:00406) VARCHAR MIXED
 , "CURRENT_MONTH"
  POSITION(  00407:00408) DECIMAL
   )
LOAD DATA INDDN(SREC) REPLACE REUSE LOG NO WORKDDN (SUT1,SOUT) NOCOPYPEND SORTKEYS 0 SORTDEVT SYSDA SORTNUM 5 
 INTO TABLE
 "PFSE01".
 "M_LOGISTIEKE_GEBEURTENIS"
 IGNOREFIELDS YES
 ( "M_BEHANDELING_ID"
  POSITION(  00003:00010) BIGINT
 , "VOLGNR_GEBEURTENIS"
  POSITION(  00011:00012) SMALLINT
 , "COMPONENT"
  POSITION(  00013:00046) VARCHAR MIXED
 , "DETAILS"
  POSITION(  00048:06049) VARCHAR MIXED
                          NULLIF(00047)=X'FF'
 , "CURRENT_MONTH"
  POSITION(  06050:06051) DECIMAL
   )
LOAD DATA INDDN(SREC) REPLACE REUSE LOG NO WORKDDN (SUT1,SOUT) NOCOPYPEND SORTKEYS 0 SORTDEVT SYSDA SORTNUM 5 
 INTO TABLE
 "PFSE01".
 "M_BETALING"
 IGNOREFIELDS YES
 ( "M_BETALING_ID"
  POSITION(  00003:00010) BIGINT
 , "M_STATEMENT_ID"
  POSITION(  00011:00018) BIGINT
 , "IBAN_BELASTINGDIENST"
  POSITION(  00019:00062) VARCHAR MIXED
 , "B_ENTRY_ID"
  POSITION(  00063:00070) BIGINT
 , "MUTATIE_ID"
  POSITION(  00072:00108) VARCHAR MIXED
                          NULLIF(00071)=X'FF'
 , "ENTRY_BEDRAG"
  POSITION(  00110:00119) DECIMAL
                          NULLIF(00109)=X'FF'
 , "BOEKDATUM"
  POSITION(  00120:00129) DATE EXTERNAL
 , "ENTRY_XML_SNIPPET"
  POSITION(  00130:11131) VARCHAR MIXED
 , "CURRENT_MONTH"
  POSITION(  11132:11133) DECIMAL
   )
LOAD DATA INDDN(SREC) REPLACE REUSE LOG NO WORKDDN (SUT1,SOUT) NOCOPYPEND SORTKEYS 0 SORTDEVT SYSDA SORTNUM 5
 INTO TABLE
 "PFSE01".
 "M_BEHANDELING"
 IGNOREFIELDS YES
 ( "M_BEHANDELING_ID"
  POSITION(  00003:00010) BIGINT
 , "M_BETALING_ID"
  POSITION(  00011:00018) BIGINT
 , "CURRENT_MONTH"
  POSITION(  00019:00020) DECIMAL
   )
LOAD DATA INDDN(SREC) REPLACE REUSE LOG NO WORKDDN (SUT1,SOUT) NOCOPYPEND SORTKEYS 0 SORTDEVT SYSDA SORTNUM 5
 INTO TABLE
 "PFSE01".
 "M_BEHANDELING_STATUS"
 IGNOREFIELDS YES
 ( "M_BEHANDELING_ID"
  POSITION(  00003:00010) BIGINT
 , "BEHANDELING_STATUS"
  POSITION(  00011:00011) CHAR MIXED(001)
   )
 ', '');
