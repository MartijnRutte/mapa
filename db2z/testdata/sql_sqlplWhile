
--#SET TERMINATOR @

CREATE PROCEDURE COUNT_UNTIL_SPACE(OUT COUNTER INTEGER) 
   LANGUAGE SQL 
   BEGIN 
      DECLARE MY_COUNTER INTEGER DEFAULT 0; 
      DECLARE MY_V1 VARCHAR(12); 
      DECLARE MY_V2 CHAR(1); 
      DECLARE MY_V3 VARCHAR(15); 
      DECLARE CSR1 CURSOR FOR 
         SELECT C1, C2, C3  
           FROM T1; 
      DECLARE EXIT HANDLER FOR NOT FOUND 
         SET COUNTER = -1; 
      OPEN CSR1; 
      FETCH_LOOP: 
      WHILE SQLCODE = 0 DO
        FETCH CSR1 INTO MY_V1, MY_V2, MY_V3;
        IF MY_V2 = ' ' THEN 
          LEAVE FETCH_LOOP;
        END IF;
        SET MY_COUNTER = MY_COUNTER + 1;
      END WHILE FETCH_LOOP; 
      SET COUNTER = MY_COUNTER; 
      CLOSE CSR1; 
   END
@

CREATE PROCEDURE COUNT_UNTIL_SPACE(OUT COUNTER INTEGER) 
   LANGUAGE SQL 
   BEGIN 
      DECLARE MY_COUNTER INTEGER DEFAULT 0; 
      DECLARE MY_V1 VARCHAR(12); 
      DECLARE MY_V2 CHAR(1) DEFAULT 'X'; 
      DECLARE MY_V3 VARCHAR(15); 
      DECLARE CSR1 CURSOR FOR 
         SELECT C1, C2, C3  
           FROM T1; 
      DECLARE EXIT HANDLER FOR NOT FOUND 
         SET COUNTER = -1; 
      OPEN CSR1; 
      WHILE SQLCODE = 0 AND MY_V2 <> ' ' DO
        FETCH CSR1 INTO MY_V1, MY_V2, MY_V3;
        IF MY_V2 <> ' ' THEN 
          SET MY_COUNTER = MY_COUNTER + 1;
        END IF; 
      END WHILE; 
      SET COUNTER = MY_COUNTER; 
      CLOSE CSR1; 
   END
@

