SELECT
    THE.ID
  , A.VALUE AS A
  , B.VALUE AS B
  , C.VALUE AS C
  , D.VALUE AS D
FROM INVENTORY AS THE
LEFT OUTER JOIN DETAILS AS A
  ON THE.ID = A.ID
  AND A.DETAIL_TYPE = 'A'
LEFT OUTER JOIN DETAILS AS B
  ON THE.ID = B.ID
  AND B.DETAIL_TYPE = 'B'
LEFT OUTER JOIN DETAILS AS C
  ON THE.ID = C.ID
  AND C.DETAIL_TYPE = 'C'
LEFT OUTER JOIN DETAILS AS D
  ON THE.ID = D.ID
  AND D.DETAIL_TYPE = 'D'
WHERE THE.ID = 'ABC'
;

SELECT
    C1
  , C2
  , C#
  , SUM(C#) OVER (PARTITION BY CEIL(C1/5.0)
    ORDER BY C2
    RANGE BETWEEN UNBOUNDED PRECEDING
    AND CURRENT ROW) RUNNING_TOTAL
  , SUM(C#) OVER (PARTITION BY CEIL(C1/5.0)) TOTAL
  , CASE WHEN MOD(C1,5.0) = 0 THEN 'X' END GRP_END
FROM T1
;

SELECT A."ABC", A.'XYZ' FROM T1 A WHERE A."MNO" = '123';

SELECT
    C1
  , C2
  , CASE GROUPING(C1) || GROUPING(C2)
         WHEN '00' THEN 'TOTAL BY C1 AND C2'
         WHEN '10' THEN 'TOTAL BY C2'
         WHEN '01' THEN 'TOTAL BY C1'
         WHEN '11' THEN 'GRAND TOTAL'
    END AS CATEGORY
  , SUM(C3) C3
FROM T1
GROUP BY GROUPING SETS ((C1),(C2),(C1,C2),())
;

SELECT
    C1
  , C2
  , C3
  , C4
  , CASE
        WHEN C4 = MAX_BY_C1 THEN 'TOP IN C1'
        WHEN C4 = MIN_BY_C1 THEN 'LOW IN C1'
    END C1_STATUS
  , CASE
        WHEN C4 = MAX_BY_C3 THEN 'TOP IN C3'
        WHEN C4 = MIN_BY_C3 THEN 'LOW IN C3'
    END C3_STATUS
FROM
    (SELECT
         C1
       , C2
       , C3
       , C4
       , MAX(C4) OVER (PARTITION BY C1) MAX_BY_C1
       , MAX(C4) OVER (PARTITION BY C3) MAX_BY_C3
       , MIN(C4) OVER (PARTITION BY C1) MIN_BY_C1
       , MIN(C4) OVER (PARTITION BY C3) MIN_BY_C3
     FROM T1) X
WHERE
    C4 IN (MAX_BY_C1, MAX_BY_C3, MIN_BY_C1, MIN_BY_C3)
;

SELECT
    C1
  , C2
  , (SELECT MAX(B.C2)
     FROM T1 B
     WHERE B.C1 = A.C1
       AND B.C3 = 
           (SELECT MAX(C.C3)
            FROM T1 C
            WHERE C.C1 = A.C1))
FROM T1 A
;

SELECT
    C1
  , C2
  , (SELECT MAX(B.C2)
     FROM T1 B
     WHERE B.C1 = A.C1
       AND B.C3 = 
           (SELECT MAX(C.C3)
            FROM T1 C
            WHERE C.C1 IN
                  (SELECT
                       DISTINCT D.C1
                   FROM T1 D
                   WHERE D.C4 IN
                         (SELECT
                              DISTINCT E.C4
                          FROM T1 E
                          WHERE E.C5 = 1))))
FROM T1 A
;


